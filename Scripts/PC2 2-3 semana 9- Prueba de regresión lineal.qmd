---
title: "PRACTICA 9 Y 10
author: GRUPO 6
format: html
editor: visual
---

## **PRACTICA N¬∫ 9**

# Cargar e instalar paquetes

```{r}
install.packages("car") # Para la prueba de Levene
```

```{r}
library(tidyverse)
library(here)
library(rio)
library(gtsummary)
library(car)
```

# Cargando los datos

```{r}
data_cancercervical <- import(here("data","conoc_actit_factor_cancer_cervical.csv"))
```

# Sobre los datos para esta pr√°ctica

El dataset conoc_actit_factor_cancer_cervical, conformado por 218 mujeres adultas, contiene informaci√≥n sobre conocimientos, actitudes y factores de riesgo asociados al c√°ncer de cuello uterino.

Incluye 18 variables que abarcan aspectos sociodemogr√°ficos (como *edad*, *estado civil*, *nivel educativo*, *religi√≥n*, *etnia*, *procedencia* y *ocupaci√≥n*), as√≠ como antecedentes personales y reproductivos (*edad de inicio de relaciones sexuales*, *n√∫mero de parejas sexuales*, *n√∫mero de hijos*, *uso de m√©todos anticonceptivos*, *antecedentes familiares* y *enfermedades de transmisi√≥n sexual*).

Este conjunto de datos permite analizar el nivel de conocimiento y las actitudes frente a la prevenci√≥n del c√°ncer de cuello uterino, adem√°s de explorar la relaci√≥n entre factores personales, reproductivos y conductuales con la presencia de factores de riesgo.

# 1 Regresi√≥n lineal simple

## 1.1 El problema en este ejercicio

El desenlace *Y* de inter√©s para este ejercicio es la variable edad. Veamos la distribuci√≥n de la variable y el promedio en en un histograma.

```{r}
data_cancer_cervical |>  
  ggplot(aes(x = edad)) +
  geom_histogram(color = "white", fill = "skyblue", bins = 20) +
  labs(
    y = "Frecuencia", 
    x = "Edad (a√±os)",
    title = "Distribuci√≥n de la edad de las participantes"
  ) +
  geom_vline(
    xintercept = mean(data_cancer_cervical$edad, na.rm = TRUE),
    color = "darkred",
    size = 1.5)
```

En estos datos, el promedio de la glucosa es:

```{r}
mean(data_cancer_cervical$edad, na.rm = TRUE)
```

A partir del histograma de la edad y del valor promedio obtenido (45.4 a√±os), se observa que la mayor√≠a de las participantes del estudio se concentran en edades medias y adultas. Esto sugiere que la poblaci√≥n evaluada est√° compuesta principalmente por mujeres en etapas de vida reproductiva tard√≠a o perimenop√°usica, grupo en el cual el tamizaje para c√°ncer de cuello uterino cobra especial relevancia debido al mayor riesgo acumulado de exposici√≥n a factores predisponentes.

La distribuci√≥n no parece sim√©trica, lo que podr√≠a indicar una ligera concentraci√≥n hacia edades mayores respecto al promedio. Esta caracter√≠stica puede tener implicancias en la interpretaci√≥n de los niveles de conocimiento y actitudes frente a la prevenci√≥n del c√°ncer cervical, ya que la edad suele relacionarse con la experiencia reproductiva, el acceso a servicios de salud y la percepci√≥n del riesgo.

## 1.2 Notaci√≥n en el m√©todo de regresi√≥n lineal simple

```{r}
plot(num_hijos ~ edad_relacion_sexual, data = data_cancer_cervical,
     col = "gray",
     ylab = "N√∫mero de hijos",
     xlab = "Edad de inicio de relaciones sexuales (a√±os)",
     las = 1,
     pch = 20, 
     font.lab = 2, font.axis = 2)

# L√≠nea de regresi√≥n lineal
abline(lm(num_hijos ~ edad_relacion_sexual, data = data_cancer_cervical),
       lwd = 2, col = "darkred")
```

A partir del gr√°fico, se puede observar que **las mujeres que iniciaron relaciones sexuales a edades m√°s tempranas tienden a tener un mayor n√∫mero de hijos**, lo cual es coherente con la relaci√≥n esperada entre inicio temprano de la vida sexual y mayor tiempo de exposici√≥n reproductiva.\
La pendiente negativa de la l√≠nea de regresi√≥n indica una **relaci√≥n inversa moderada** entre ambas variables.

La ecuaci√≥n siguiente ecuaci√≥n describe un modelo de regresi√≥n lineal simple para ùëå usando un predictor continuo ùëã. $$
Y = \beta_0 + \beta_1 X + \epsilon
$$ Cuando ajustamos un modelo de regresi√≥n lineal simple a nuestros datos, estimamos (hallamos) los par√°metros del modelo que mejor explican la relaci√≥n entre las dos variables ‚Äîla variable dependiente o desenlace (Y) y la variable independiente o predictor (X)‚Äî, incluyendo los coeficientes (Œ≤0,Œ≤1) y el error (œµ), que representa la variabilidad no explicada por el modelo.

En este caso, el modelo analiza la relaci√≥n entre el n√∫mero de hijos (Y) y la edad de inicio de las relaciones sexuales (X).\
El intercepto (Œ≤0) representa el n√∫mero promedio de hijos cuando la edad de inicio sexual es igual a cero (aunque este valor carezca de sentido pr√°ctico, tiene importancia matem√°tica).\
La pendiente (Œ≤1‚Äã) indica el cambio promedio en el n√∫mero de hijos por cada a√±o adicional en la edad de inicio de las relaciones sexuales.\
Finalmente, el t√©rmino de error (œµ) recoge la variaci√≥n individual no explicada √∫nicamente por la edad de inicio sexual.

As√≠, dado que el objetivo es estimar los par√°metros Œ≤0,Œ≤1‚Äã y œµ, se puede afirmar que estamos ajustando un modelo de regresi√≥n lineal simple para el problema planteado ‚Äîesto es, la asociaci√≥n entre la edad de inicio sexual y el n√∫mero de hijos en la poblaci√≥n analizada.

## 1.3 Ajustando el modelo de regresi√≥n lineal simple para nuestro problema

Ajustando el modelo para nuestros datos

```{r}
modelo_cancer = lm(num_hijos ~ edad_relacion_sexual, 
                   data = data_cancer_cervical)
```

Para ver los resultados, usamos la funci√≥n summary() y dentro, el objeto modelo_ejemplo.

```{r}
summary(modelo_cancer)
```

-   <div>

    -   Intercepto (Œ≤‚ÇÄ = 4.61):\
        Representa el n√∫mero promedio de hijos cuando la edad de inicio de las relaciones sexuales es 0 a√±os. Aunque este valor no tiene sentido pr√°ctico (ya que no existen edades de inicio tan bajas), sirve como punto de referencia matem√°tico para el modelo.

    </div>

    -   Pendiente (Œ≤‚ÇÅ = -0.1318):\
        Indica que, por cada a√±o adicional en la edad de inicio de las relaciones sexuales, el n√∫mero promedio de hijos disminuye en aproximadamente 0.13 hijos.\
        En otras palabras, las mujeres que comienzan su vida sexual a mayor edad tienden a tener menos hijos, lo que es coherente con el razonamiento demogr√°fico: un inicio sexual m√°s tard√≠o reduce el tiempo de exposici√≥n a embarazos.

    -   Coeficiente de determinaci√≥n (R¬≤ = 0.053):\
        El modelo explica alrededor del 5.3% de la variabilidad en el n√∫mero de hijos. Esto sugiere que la edad de inicio sexual tiene una relaci√≥n estad√≠sticamente significativa (p \< 0.001) con el n√∫mero de hijos, pero no es el √∫nico factor que influye ‚Äîhay otros elementos (como estado civil, uso de anticonceptivos o nivel educativo) que tambi√©n intervienen.

## 1.4 Interpretando los resultados

La secci√≥n Coefficients del resultado:

```{r}
summary(modelo_cancer)$coef
```

En la tabla de resultados del modelo de regresi√≥n lineal simple se muestran las estimaciones y pruebas de hip√≥tesis para el intercepto (Œ≤0), etiquetado como *(Intercept)*, y para el coeficiente de la edad de inicio de relaciones sexuales (la pendiente, Œ≤1), etiquetado como *edad_relacion_sexual*.

La columna Estimate muestra los coeficientes estimados del modelo de regresi√≥n lineal simple. As√≠, el modelo que mejor se ajusta tiene un intercepto de 4.6075 y una pendiente de -0.1318.

La tabla tambi√©n presenta el error est√°ndar de cada estimaci√≥n, el valor t y el valor p (*Pr(\>\|t\|)*).\
El valor p del intercepto usualmente no es de inter√©s, pero el valor p del predictor (*edad_relacion_sexual*) prueba la hip√≥tesis nula de que no existe asociaci√≥n entre el n√∫mero de hijos y la edad de inicio sexual, es decir, que la pendiente es igual a cero.

Dado que el valor p del predictor es 0.000578 (\< 0.001), se rechaza la hip√≥tesis nula, lo que indica que existe una asociaci√≥n estad√≠sticamente significativa entre ambas variables.\
La pendiente negativa sugiere que a mayor edad de inicio de las relaciones sexuales, menor n√∫mero promedio de hijos.

Finalmente, el valor R¬≤ = 0.053 representa la bondad de ajuste del modelo. Este valor indica que aproximadamente el 5.3% de la variabilidad en el n√∫mero de hijos se explica por la edad de inicio de las relaciones sexuales. Si bien la asociaci√≥n es significativa, la proporci√≥n de variaci√≥n explicada es baja, lo que sugiere que otros factores tambi√©n influyen en el n√∫mero de hijos.

## 1.5 ¬øC√≥mo reportar los resultados del ajuste del modelo de regresi√≥n lineal simple?

```{r}
theme_gtsummary_language("es")

tabla_reporte <- modelo_cancer |> 
  tbl_regression(
    intercept = TRUE,
    estimate_fun = function(x) style_sigfig(x, digits = 4),
    pvalue_fun   = function(x) style_pvalue(x, digits = 3),
    label = list(edad_relacion_sexual ~ "Edad de inicio de relaciones sexuales (a√±os)")
  ) |>
  modify_caption("Regresi√≥n del n√∫mero de hijos en funci√≥n de la edad de inicio de relaciones sexuales")

tabla_reporte
```

**Exportamos la tabla**

```{r}
tabla_reporte |> 
  as_flex_table()  |> 
  flextable::save_as_docx(path = "tabla_reporte.docx")
```

# 2 Prueba t de Student para muestras independientes

## 2.1 ¬øCu√°ndo usar la prueba t de Student para muestras independientes?

-   Cuando los dos grupos de muestras a comparar han sido muestreadas de una distribuci√≥n normal. Aqu√≠ podemos usar la prueba de Shapiro-Wilk.

-   Cuando las varianzas de los dos grupos son iguales. Esto puede ser evaluado con la prueba F.

Usualmente, la hip√≥tesis de la prueba t de Student son:

-   Hip√≥tesis nula (H‚ÇÄ): No hay diferencia entre las medias de los dos grupos. $$
    H_0: \mu_1 = \mu_2
    $$
-   Hip√≥tesis alternativa (H‚ÇÅ): Hay una diferencia entre las medias de los dos grupos. $$
    H_1: \mu_1 \neq \mu_2
    $$

## 2.2 Sobre los datos para esta pr√°ctica

El dataset conoc_actit_factor_cancer_cervical, conformado por 218 mujeres adultas, contiene informaci√≥n sobre conocimientos, actitudes y factores de riesgo asociados al c√°ncer de cuello uterino.

Incluye 18 variables que abarcan aspectos sociodemogr√°ficos (como *edad*, *estado civil*, *nivel educativo*, *religi√≥n*, *etnia*, *procedencia* y *ocupaci√≥n*), as√≠ como antecedentes personales y reproductivos (*edad de inicio de relaciones sexuales*, *n√∫mero de parejas sexuales*, *n√∫mero de hijos*, *uso de m√©todos anticonceptivos*, *antecedentes familiares* y *enfermedades de transmisi√≥n sexual*).

## 2.3 Resumen y visualizaci√≥n

Resumen

Antes de realizar la prueba t de Student es importante conocer la distribuci√≥n de los datos e identificar si hay valores perdidos o at√≠picos. Empecemos por el resumen:

```{r}
data_cancer_cervical |> 
group_by(e_marital) |> 
  summarise(
    count = n(),
    mean = mean(num_hijos, na.rm = TRUE),
    sd   = sd(num_hijos, na.rm = TRUE)
  )
```

Visualizaci√≥n

```{r}
data_cancer_cervical |>  
  filter(!is.na(e_marital) & !is.na(num_hijos)) |> 
  ggplot(aes(x = e_marital, y = num_hijos)) +
  geom_boxplot() +
  labs(
    x = "Estado civil",
    y = "N√∫mero de hijos"
  )
```

## 2.4 Pruebas preliminares para evaluar los supuestos de la prueba t de Student

Supuesto 1: los datos deben haber sido muestreados de una distribuci√≥n normal.

Para esto, usamos la prueba de Shapiro-wilk.

```{r}
data_cancer_cervical |> 
   filter(e_marital == "Casada") |> 
  summarise(shapiro = list(shapiro.test(num_hijos))) |> 
  pull(shapiro)
```

```{r}
data_cancer_cervical |> 
  filter(e_marital == "Casada") |> 
  summarise(shapiro = list(shapiro.test(num_hijos))) |> 
  pull(shapiro)
```

#### 1. Grupo: Soltera

> La prueba de Shapiro-Wilk para el n√∫mero de hijos en mujeres con estado civil Soltera arroj√≥ un valor p = 0.012.
>
> -   Si p ‚â• 0.05 ‚Üí Se concluye que la distribuci√≥n del n√∫mero de hijos no se desv√≠a significativamente de la normalidad.
>
> -   Si p \< 0.05 ‚Üí Se concluye que el n√∫mero de hijos no sigue una distribuci√≥n normal en este grupo.
>
>     #### 2. Grupo: Casada
>
>     > La prueba de Shapiro-Wilk para el n√∫mero de hijos en mujeres con estado civil Casada dio un valor p = 0.2.
>     >
>     > -   Si p ‚â• 0.05 ‚Üí La distribuci√≥n del n√∫mero de hijos puede considerarse normal en este grupo.
>     >
>     > -   Si p \< 0.05 ‚Üí La distribuci√≥n del n√∫mero de hijos no es normal en este grupo.

```{r}
var.test(num_hijos ~ e_marital, data = data_cancer_cervical)
```

## 2.5 Realizamos la prueba t para nuestros datos.

```{r}
t.test(num_hijos ~ e_marital, data = data_cancer_cervical, var.equal = TRUE)
```

**Interpretando los resultados**

Se realiz√≥ una prueba t de Student para muestras independientes con el objetivo de comparar el promedio de n√∫mero de hijos (num_hijos) entre los diferentes estados civiles (e_marital).\
Antes de ello, se asumi√≥ igualdad de varianzas debido a que se especific√≥ `var.equal = TRUE`.

> **Hip√≥tesis:**
>
> -   **H‚ÇÄ (nula):** El n√∫mero promedio de hijos es igual entre los grupos de estado civil
>
> -   **H‚ÇÅ (alternativa):** El n√∫mero promedio de hijos es diferente entre los grupos de estado civil.

# 3 An√°lisis de Varianza (ANOVA)

## 3.1 Resumen y visualizaci√≥n

Resumen

Antes de realizar la prueba de ANOVA es importante conocer la distribuci√≥n de los datos e identificar si hay at√≠picos. Empecemos por el resumen:

```{r}
group_by(data_cancer_cervical, conocimiento) |> 
 summarise(
    count = n(),
    mean = mean(num_hijos, na.rm = TRUE),
    sd = sd(num_hijos, na.rm = TRUE),
    min = min(num_hijos, na.rm = TRUE),
    max = max(num_hijos, na.rm = TRUE)
  )
```

Visualizaci√≥n

```{r}
data_cancer_cervical |>  
  filter(!is.na(conocimiento) & !is.na(edad_relacion_sexual)) |> 
  ggplot(aes(y = conocimiento, x = edad_relacion_sexual)) +
  geom_boxplot() +
  labs(y = "conocimiento", x = "edad_relacion_sexual")
```

## 3.2 Pruebas preliminares para evaluar los supuestos del ANOVA

```{r}
data_cancer_cervical <- data_cancer_cervical |>
    mutate(conocimiento = as.factor(conocimiento))
```

Supuesto 1: los datos deben haber sido muestreados de una distribuci√≥n normal.

Para esto, usamos la prueba de Shapiro-wilk.

```{r}
data_cancer_cervical |> 
  filter(conocimiento == "alto") |> 
  summarise(shapiro = list(shapiro.test(edad_relacion_sexual))) |> 
  pull(shapiro)
```

```{r}
data_cancer_cervical |> 
  filter(conocimiento == "medio") |> 
  summarise(shapiro = list(shapiro.test(edad_relacion_sexual))) |> 
  pull(shapiro)
```

```{r}
data_cancer_cervical |> 
  filter(conocimiento == "negativo") |> 
  summarise(shapiro = list(shapiro.test(edad_relacion_sexual))) |> 
  pull(shapiro)
```

Supuesto 2: Las varianzas de los dos grupos son iguales Para esto podemos usar la prueba de Levene para evaluar la homogeneidad de varianzas. Esto esta implementado en la funci√≥n var.test()

```{r}
leveneTest(edad_relacion_sexual ~ conocimiento, data = data_cancer_cervical)
```

## 3.3 Realizamos la prueba de ANOVA de una v√≠a para nuestros datos.

```{r}
res_anova = aov(edad_relacion_sexual ~ conocimiento, data = data_cancer_cervical)
```

```{r}
summary(res_anova)
```

```{r}
TukeyHSD(res_anova)
```

El an√°lisis Tukey compara los promedios de la edad de inicio de relaciones sexuales entre los distintos niveles de conocimiento sobre el c√°ncer cervical (‚Äúalto‚Äù, ‚Äúmedio‚Äù, ‚Äúbajo‚Äù y ‚Äúno conoce‚Äù).

En todas las comparaciones del cuadro, el valor p ajustado (p adj) es mayor a 0.05.\
Esto significa que no existen diferencias estad√≠sticamente significativas entre los grupos en t√©rminos de la edad de inicio de relaciones sexuales.

Por ejemplo, la comparaci√≥n bajo vs alto muestra una diferencia de medias de -0.52 a√±os (aprox. medio a√±o), pero con p = 0.54 ‚Üí no significativa.

La comparaci√≥n no conoce vs alto tiene p = 0.99 ‚Üí tampoco significativa.

Todas las dem√°s comparaciones (medio vs alto, medio vs bajo, etc.) tambi√©n presentan p \> 0.05, confirmando que las diferencias observadas podr√≠an deberse al azar.

## **PRACTICA N¬∫ 10**

# Cargar e instalar paquetes

```{r}
library(tidyverse) 
library(here) 
library(rio) 
library(gtsummary) 
library(car)
```

## Cargando los datos

```{r}
data_cancer_cervical <- import(here("data", "conoc_actit_factor_cancer_cervical.csv"))
```

```{r}
CONOCIMIENTO <- import(here("data", "conoc_actit_factor_cancer_cervical.csv"))
```

## Sobre los datos para esta pr√°ctica

## 1.1 Aspectos b√°sicos para la interpretaci√≥n la regresi√≥n log√≠stica

## 1.1 El problema en este ejercicio

El desenlace de inter√©s en este an√°lisis es la edad de inicio de relaciones sexuales (`edad_relacion_sexual`). Nuestro objetivo es evaluar la relaci√≥n entre la edad de inicio de relaciones sexuales y el nivel de conocimiento sobre c√°ncer de cuello uterino (`conocimiento`) en las participantes del estudio.

En este contexto, el nivel de conocimiento act√∫a como la variable explicativa o de exposici√≥n, categorizada en niveles (alto, medio, bajo y no conoce), mientras que la edad de inicio de relaciones sexuales es tratada como una variable num√©rica continua. El an√°lisis permitir√° determinar si existen diferencias estad√≠sticamente significativas en la edad de inicio de relaciones sexuales seg√∫n el nivel de conocimiento sobre c√°ncer cervical.

## 1.2 Estimando OR usando regresi√≥n log√≠stica para un predictor categ√≥rico

Antes de estimar el OR (odds ratio) mediante regresi√≥n log√≠stica, es necesario asegurarnos de que la variable tabaquismo est√© codificada como una variable categ√≥rica en R. Adem√°s, establecemos la categor√≠a "No" como el nivel de referencia, de manera que el modelo estime el OR de ser fumadora en comparaci√≥n con no ser fumadora.

De igual forma, convertimos la variable conocimiento en factor y definimos como referencia la categor√≠a "alto", permitiendo as√≠ interpretar los OR de los otros niveles de conocimiento (medio, bajo y no conoce) en relaci√≥n con el nivel alto de conocimiento sobre c√°ncer cervical.

De esta manera, el modelo log√≠stico nos permitir√° evaluar si los niveles m√°s bajos de conocimiento se asocian con mayor probabilidad de tabaquismo entre las participantes del estudio.

```{r}
data_cancer_cervical_1 <- data_cancer_cervical |> 
  mutate(
    e_marital = relevel(e_marital, ref = "soltera"),
    conocimiento = relevel(as.factor(conocimiento), ref = "alto")
  )
```

A continuaci√≥n, usamos la funci√≥n `glm()`, general linear model, con el argumento family = binomial para ajustar una regresi√≥n log√≠stica y `summary()` para ver los resultados.

```{r}
regre_log <- glm(e_marital ~ conocimiento,         
                 family = binomial,                 
                 data = data_cancer_cervical_1)

summary(regre_log)
```

El coeficiente de regresi√≥n para *hipertSi* representa el logaritmo del OR para fallecer, comparando pacientes hipertensos con pacientes no hipertensos.

Para obtener el OR en s√≠ (como usualmente se reporta en los estudios), exponenciamos el coeficiente usando la funci√≥n exp()

```{r}
exp(coef(regre_log)[-1]) # [-1] elimina la primera fila, al intercepto.
```

Usamos la funci√≥n `confint()` para calcular los intervalos de confianza (IC) al 95% para el coeficientes de regresi√≥n, y exponenciamos estos valores para obtener los IC del 95% para los OR.

```{r}
exp(confint(regre_log))[-1, , drop=F]
```

## 1.4 Ajustamos el modelo

```{r}
regre_log_1 <- glm(actitud ~ edad_relacion_sexual,
                   family = binomial,
                   data = data_cancer_cervical_1)
summary(regre_log_1)$coefficients
```

El coeficiente de regresi√≥n para la edad (0.0583) indica cu√°nto cambia el logaritmo de las odds del desenlace por cada aumento de un a√±o en la edad. Si convertimos esto a un OR exponenciandolos, obtenemos:

```{r}
exp(coef(regre_log_1)[-1])
```

Finalmente, calcula un intervalo de confianza del 95% para el OR usando `confint()` y exponenciando los resultados.

```{r}
exp(confint(regre_log_1)[-1,])
```

## 1.8 C√≥mo reportar los resultados de una regresi√≥n log√≠stica para un reporte cient√≠fico.

Aqu√≠ usamos funciones que ya hemos empleado en sesiones anteriores. tbl_uvregression() es la funci√≥n que permite producir tablas con resultados de la regresi√≥n log√≠stica. Como argumento incluye el tipo de regresi√≥n, variables y otras especificaciones.

```{r}
theme_gtsummary_language(language = "es")
```

```{r}
tabla_reg_logi <- data_cancer_cervical_1 |> 
  tbl_uvregression(
    y = actitud,
    include = c(edad_relacion_sexual, e_marital, conocimiento),
    method = glm,
    method.args = list(family = binomial),
    exponentiate = TRUE,       # Mostrar OR
    conf.int = TRUE,           # Mostrar IC95%
    hide_n = TRUE,
    add_estimate_to_reference_rows = FALSE,
    pvalue_fun = ~ style_pvalue(.x, digits = 3),
    estimate_fun = ~ style_number(.x, digits = 2),
    label = list(
      edad_relacion_sexual ~ "Edad de primera relaci√≥n sexual (a√±os)",
      e_marital ~ "Estado civil",
      conocimiento ~ "Nivel de conocimiento"
    )
  ) |> 
  bold_labels() |> 
  bold_p(t = 0.05) |> 
  modify_header(estimate = "**OR no ajustado**", p.value = "**Valor P**")

tabla_reg_logi
```

Imprime la tabla

```{r}
tabla_reg_logi
```

## 2 Regresi√≥n de Poisson

La regresi√≥n de Poisson es un modelo de regresi√≥n para datos de conteo y de tasas. Al igual que el modelo de regresi√≥n log√≠stica, este es un tipo de modelo lineal generalizado que se usa cuando el desenlace (variable dependiente) es un conteo. Aunque los datos de conteo y tasas son muy comunes en medicina y ciencias de la salud, la regresi√≥n de Poisson est√° subutilizada en la investigaci√≥n m√©dica.

B√°sicamente, la regresi√≥n de Poisson modela la relaci√≥n lineal entre:

Desenlace: variable de conteo (por ejemplo, n√∫mero de hospitalizaciones, paridad, lesiones cancerosas, ataques asm√°ticos). Esta variable se transforma a escala de logaritmo natural.

Predictores/variables independientes: variables num√©ricas (por ejemplo, edad, presi√≥n arterial) y variables categ√≥ricas (por ejemplo, raza, g√©nero, nivel educativo).

Usando la regresi√≥n de poisson, podemos evaluar: La relaci√≥n entre el n√∫mero de ataques asm√°ticos en el √∫ltimo a√±o y los factores sociodemogr√°ficos.

En la secci√≥n anterior, reportamos como medida de efecto OR para la regresi√≥n log√≠stica. Para la regresi√≥n de Poisson, al tomar el exponente del coeficiente, obtenemos la raz√≥n de tasas (rate ratio, RR), tambi√©n conocida como raz√≥n de tasas de incidencia (incidence rate ratio, IRR).

## 2.1 Sobre los datos para esta pr√°ctica

## 2.2 El problema en este ejercicio

Usando regresi√≥n de Poisson evaluaremos la relaci√≥n entre el n√∫mero de ataques asm√°ticos (variable episod_asma) en el √∫ltimo a√±o y los factores sociodemogr√°ficos.

## 2.3 Ajustamos modelos de regresi√≥n de Poisson

Ahora, ajustamos modelos de regresi√≥n de Poisson para las 3 variables predictoras usando la funci√≥n glm(). Seguido a esto, usamos summary() para ver los resultados.

Para la variable sexo

```{r}
reg_poisson1 <- glm(parejas_sex ~ conocimiento, 
                    data = asma, 
                    family = "poisson")
```

El modelo Poisson estima la relaci√≥n entre el n√∫mero de parejas sexuales (`parejas_sex`) y el nivel de conocimiento (`conocimiento`).

-   Si el coeficiente asociado a `conocimiento` es negativo, significa que a mayor nivel de conocimiento sobre el c√°ncer cervical, menor n√∫mero de parejas sexuales (efecto protector)

-   Si el coeficiente es positivo, implica que un mayor conocimiento se asocia a m√°s parejas sexuales (posible confusi√≥n o influencia de otro factor).

## 2.4 C√≥mo interpretar y reportar los resultados de una regresi√≥n de Poisson

Como en la secci√≥n anterior, usamos tbl_regression() para generar una tabla con los resultados. Aqu√≠, para la interpretaci√≥n, exponenciamos los coeficientes para obtener la raz√≥n de tasas de incidencia (IRR).

`tabla_reg_poisson <- cancer |>`

`tbl_uvregression(`

`include = c(antec_ets, conocimiento, actitud),`

`y = parejas_sex,`

`method = glm,`

`method.args = list(family = poisson),`

`exponentiate = TRUE,`

`conf.int = TRUE,`

`hide_n = TRUE,`

`add_estimate_to_reference_rows = FALSE,`

`pvalue_fun = ~ style_pvalue(.x, digits = 3),`

`estimate_fun = ~ style_number(.x, digits = 2),`

`label = list(`

`antec_ets ~ "Antecedente de ETS",`

`conocimiento ~ "Nivel de conocimiento",`

`actitud ~ "Actitud preventiva"`

`)`

`) |>`

`bold_labels() |>`

`bold_p(t = 0.05) |>`

`modify_header(estimate = "**IRR no ajustado**", p.value = "**Valor P**")`

Imprime la tabla

`{r} tabla_reg_poisson}`
